{% extends "layout.html" %}

{% block content %}
    <h2>Add New Transaction</h2>
    <form action="{{ url_for('add') }}" method="POST">
        <p>
            <label>Type:</label><br>
            <select name="type" id="type-select" onchange="updateCategories()" required>
                <option value="expense">Expense</option>
                <option value="income">Income</option>
            </select>
        </p>
        <p>
            <label>Category:</label><br>
            <select name="category" id="category-select" required>
                </select>
        </p>
        <p>
            <label>Amount:</label><br>
            <input type="number" name="amount" step="0.01" min="0.01" required>
        </p>
         <p>
            <label>Description:</label><br>
            <input type="text" name="description" style="width: 300px;">
        </p>
        <p>
            <button type="submit">Add Transaction</button>
        </p>
    </form>

    <script>
        // JavaScript เล็กน้อยสำหรับเปลี่ยนหมวดหมู่ตามประเภท (income/expense)
        const categories = {
            income: {{ income_categories|tojson }},
            expense: {{ expense_categories|tojson }}
        };

        function updateCategories() {
            const typeSelect = document.getElementById('type-select');
            const categorySelect = document.getElementById('category-select');
            const selectedType = typeSelect.value;
            
            // ล้างตัวเลือกเก่า
            categorySelect.innerHTML = '';
            
            // เพิ่มตัวเลือกใหม่
            categories[selectedType].forEach(function(category) {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categorySelect.appendChild(option);
            });
        }
        
        // เรียกใช้ครั้งแรกตอนโหลดหน้า
        updateCategories();
    </script>
{% endblock %}